[
    {
        "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} was {action.outcome}",
        "conditions": [
            {
                "field": "source.ip"
            },
            {
                "field": "source.port"
            },
            {
                "field": "destination.ip"
            },
            {
                "field": "destination.port"
            },
            {  
                "field": "action.outcome"
            },
            {
                "field": "event.dataset",
                "value": "flows"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "requested"
            }
        ]
    },
    {
        "value": "ICMP connection from {source.ip} to {destination.ip} was {action.outcome}",
        "conditions": [
            {
                "field": "source.ip"
            },
            {
                "field": "destination.ip"
            },
            {  
                "field": "action.outcome"
            },
            {
                "field": "event.dataset",
                "value": "flows"
            },
            {
                "field": "network.protocol",
                "value": "icmp"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "requested"
            }
        ]
    },
    {
        "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} started",
        "conditions": [
            {
                "field": "source.ip"
            },
            {
                "field": "source.port"
            },
            {
                "field": "destination.ip"
            },
            {
                "field": "destination.port"
            },
            {
                "field": "event.dataset",
                "value": "ip_flow_start"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "requested"
            }
        ]
    },
    {
        "value": "Connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} ended",
        "conditions": [
            {
                "field": "source.ip"
            },
            {
                "field": "source.port"
            },
            {
                "field": "destination.ip"
            },
            {
                "field": "destination.port"
            },
            {
                "field": "event.dataset",
                "value": "ip_flow_end"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "requested"
            }
        ]
    },
    {
        "value": "ICMP connection from {source.ip} to {destination.ip} started",
        "conditions": [
            {
                "field": "source.ip"
            },
            {
                "field": "destination.ip"
            },
            {
                "field": "event.dataset",
                "value": "ip_flow_start"
            },
            {
                "field": "network.protocol",
                "value": "icmp"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "requested"
            }
        ]
    },
    {
        "value": "ICMP connection from {source.ip} to {destination.ip} ended",
        "conditions": [
            {
                "field": "source.ip"
            },
            {
                "field": "destination.ip"
            },
            {
                "field": "event.dataset",
                "value": "ip_flow_end"
            },
            {
                "field": "network.protocol",
                "value": "icmp"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "requested"
            }
        ]
    },
    {
        "value": "Source {source.ip} made {http.request.method} request to {url.original}",
        "conditions": [
            {
                "field": "url.original"
            },
            {
                "field": "event.dataset",
                "value": "urls"
            }
        ],
        "relationships": [
            {
                "source": "user.name",
                "target": "url.original",
                "type": "HTTP {http.request.method} request"
            },
            {
                "source": "url.original",
                "target": "url.domain",
                "type": "hosted on"
            },
            {
                "source": "url.domain",
                "target": "destination.ip",
                "type": "resolved to"
            },
            {
                "source": "user.name",
                "target": "source.ip",
                "type": "connected on"
            }
        ]
    },
    {
        "value": "dhcp request for {client.ip} from {client.mac}",
        "conditions": [
          {
            "field": "event.dataset",
            "value": "events"
          },
          {
            "field": "cisco_meraki.event_subtype",
            "value": "dhcp_offer"
          },
          {
            "field": "client.ip"
          },
          {
            "field": "client.mac"
          }
        ],
        "relationships": [
          {
            "source": "source.mac",
            "target": "source.ip",
            "type": "requested ip"
          }
        ]
      },
      {
        "value": "VPN connection success for user {user.name} from {client.ip}",
        "conditions": [
          {
            "field": "event.dataset",
            "value": "events"
          },
          {
            "field": "cisco_meraki.event_subtype",
            "value": "anyconnect_vpn_auth_success"
          },
          {
            "field": "client.ip"
          },
          {
            "field": "user.name"
          }
        ],
        "relationships": [
          {
            "source": "user.name",
            "target": "source.ip",
            "type": "connected from"
          }
        ]
      }
]