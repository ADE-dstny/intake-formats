[
  {
    "value": "Technique {threat.technique.name} with {microsoft.defender.threat.severity} detected",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "alert_info"
      },
      {
        "field": "threat.technique.name"
      },
      {
        "field": "microsoft.defender.threat.severity"
      }
    ],
    "relationships": [
      {
        "source": "service.name",
        "target": "threat.technique.name",
        "type": "detected attack"
      }
    ]
  },
  {
    "value": "Verification of the certificate issued by {microsoft.defender.certificate.issuer}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "device_file_certificate_info"
      },
      {
        "field": "microsoft.defender.certificate.issuer"
      }
    ],
    "relationships": [
      {
        "source": "file.x509.serial_number",
        "target": "microsoft.defender.certificate.issuer",
        "type": "issued by"
      },
      {
        "source": "file.x509.serial_number",
        "target": "microsoft.defender.certificate.signer",
        "type": "signed by"
      }
    ]
  },
  {
    "value": "New process {action.properties.InitiatingProcessFileName} created on {host.name}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "device_image_load_events"
      },
      {
        "field": "host.name"
      },
      {
        "field": "action.properties.InitiatingProcessFileName"
      }
    ],
    "relationships": [
      {
        "source": "host.name",
        "target": "action.properties.InitiatingProcessFileName",
        "type": "start process"
      }
    ]
  },
  {
    "value": "{user.domain}\\{user.name} logged on {host.name}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "device_logon_events"
      },
      {
        "field": "host.name"
      },
      {
        "field": "user.name"
      },
      {
        "field": "user.domain"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "logged on"
      }
    ]
  },
  {
    "value": "{user.name} logged on {host.name}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "device_logon_events"
      },
      {
        "field": "host.name"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "logged on"
      }
    ]
  },
  {
    "value": "{source.address} connected to {destination.address}",
    "conditions": [
      {
        "field": "event.dataset",
        "value": "device_network_events"
      },
      {
        "field": "source.address"
      },
      {
        "field": "destination.address"
      }
    ],
    "relationships": [
      {
        "source": "source.address",
        "target": "destination.address",
        "type": "connect to"
      }
    ]
  }
]
