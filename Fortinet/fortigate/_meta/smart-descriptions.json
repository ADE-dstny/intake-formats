[
    {
        "value": "{source.ip} connected to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "action.outcome",
                "value": "passthrough"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "connected to"
            }
        ]
    },
    {
        "value": "{source.ip} was denied a connection to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "action.outcome",
                "value": "block"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "was denied a connection to"
            }
        ]
    },
    {
        "value": "{source.ip} was denied a connection to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "action.outcome",
                "value": "blocked"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "was denied a connection to"
            }
        ]
    },
    {
        "value": "{source.ip} connected to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.ips"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "connected to"
            }
        ]
    },
    {
        "value": "{source.ip} was denied a connection to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.ips"
            },
            {
                "field": "action.name",
                "value": "blocked"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "was denied a connection to"
            }
        ]
    },
    {
        "value": "{source.ip} connected to malicious URL {url.original} (threat: {virus.virus})",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.antivirus"
            },
            {
                "field": "virus.virus"
            },
            {
                "field": "url.original"
            },
            {
                "field": "source.ip"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "url.original",
                "type": "connected to malicious"
            }
        ]
    },
    {
        "value": "{source.ip} was denied a connection to malicious URL {url.original} (threat: {virus.virus})",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.antivirus"
            },
            {
                "field": "action.name",
                "value": "blocked"
            },
            {
                "field": "virus.virus"
            },
            {
                "field": "url.original"
            },
            {
                "field": "source.ip"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "url.original",
                "type": "was blocked from connecting to malicious"
            }
        ]
    },
    {
        "value": "{source.ip} failed to connect to {destination.ip}:{destination.port} because of SSL anomalies",
        "conditions": [
            {
                "field": "action.type",
                "value": "ssl-anomalies"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "failed to connect to"
            }
        ]
    },
    {
        "value": "{source.ip} was denied a connection to {url.original} (category {rule.category})",
        "conditions": [
            {
                "field": "action.type",
                "value": "webfilter"
            },
            {
                "field": "action.name",
                "value": "blocked"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "url.original"
            },
            {
            "field": "rule.category"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "url.original",
                "type": "was denied a connection to"
            },
            {
                "source": "url.original",
                "target": "destination.domain",
                "type": "hosted on"
            },
            {
                "source": "destination.domain",
                "target": "destination.ip",
                "type": "resolves to"
            }
        ]
    },
    {
        "value": "{source.ip} connected to {url.domain}{url.path} on {customer.zone_name} (category {application.category})",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.webfilter"
            },
            {
                "field": "action.name",
                "value": "passthrough"
            },
            {
                "field": "url.domain"
            },
            {
                "field": "url.path"
            },
            {
                "field": "customer.zone_name"
            },
            {
                "field": "application.category"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "url.domain",
                "type": "connected to"
            },
            {
                "source": "url.domain",
                "target": "destination.ip",
                "type": "resolves to"
            }
        ]
    },
    {
        "value": "{source.ip} was denied a connection to {url.domain}{url.path} (category {application.category})",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.webfilter"
            },
            {
                "field": "action.name",
                "value": "blocked"
            },
            {
                "field": "url.domain"
            },
            {
                "field": "url.path"
            },
            {
                "field": "application.category"
            },
            {
                "field": "application.name"
            }

        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "url.domain",
                "type": "was denied a connection to"
            },
            {
                "source": "url.domain",
                "target": "destination.ip",
                "type": "resolves to"
            }
        ]
    },
    {
        "value": "{source.ip} connected to {destination.ip}:{destination.port} (recognised as {application.category}/{application.name})",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.app-ctrl"
            },
            {
                "field": "action.name",
                "value": "pass"
            }
            ,
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            },
            {
                "field": "application.category"
            },
            {
                "field": "application.name"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "connected to"
            }
        ]
    },
    {
        "value": "{source.ip} connected to {url.domain}{url.path} (recognised as {application.category}/{application.name})",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.app-ctrl"
            },
            {
                "field": "action.name",
                "value": "pass"
            },
            {
                "field": "url.domain"
            },
            {
                "field": "url.path"
            },
            {
                "field": "application.category"
            },
            {
                "field": "application.name"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "url.domain",
                "type": "connected to"
            },
            {
                "source": "url.domain",
                "target": "destination.ip",
                "type": "resolves to"
            }
        ]
    },
    {
        "value": "{source.ip} was denied a connection to {destination.ip}:{destination.port} (recognised as {application.category}/{application.name})",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.app-ctrl"
            },
            {
                "field": "action.name",
                "value": "block"
            }
            ,
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            },
            {
                "field": "application.category"
            },
            {
                "field": "application.name"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "was denied a connection to"
            }
        ]
    },
    {
        "value": "{source.ip} was denied a connection to {url.domain}{url.path} (recognised as {application.category}/{application.name})",
        "conditions": [
            {
                "field": "event.dataset",
                "value": "fortinet.app-ctrl"
            },
            {
                "field": "action.name",
                "value": "block"
            },
            {
                "field": "url.domain"
            },
            {
                "field": "url.path"
            },
            {
                "field": "application.category"
            },
            {
                "field": "application.name"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "url.domain",
                "type": "was denied a connection to"
            },
            {
                "source": "url.domain",
                "target": "destination.ip",
                "type": "resolves to"
            }
        ]
    },
    {
        "value": "{observer.hostname} denied {network.protocol} traffic initiated by {source.ip}:{source.port} to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "action.name",
                "value": "deny"
            },
            {
                "field": "action.outcome",
                "value": "success"
            },
            {
                "field": "network.protocol"
            },
            {
                "field": "observer.hostname"
            },
            {
            "field": "source.port"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "was denied a connection to"
            }
        ]
    },
    {
        "value": "{observer.hostname} accepted {network.protocol} traffic initiated by {source.ip} to {destination.ip}",
        "conditions": [
            {
                "field": "action.name",
                "value": "accept"
            },
            {
                "field": "action.outcome",
                "value": "success"
            },
            {
                "field": "network.protocol"
            },
            {
                "field": "observer.hostname"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            }
        ],
        "relationships": [
            {
                "source": "source.ip",
                "target": "destination.ip",
                "type": "connected to"
            }
        ]
    },
    {
        "value": "{observer.hostname} observed client reset {network.protocol} session initiated by {source.ip} to {destination.ip}",
        "conditions": [
            {
                "field": "action.name",
                "value": "client-rst"
            },
            {
                "field": "action.outcome",
                "value": "success"
            },
            {
                "field": "network.protocol"
            },
            {
                "field": "network.protocol"
            },
            {
                "field": "observer.hostname"
            }
            ,
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            }
        ]
    },
    {
        "value": "{observer.hostname} observed server reset {network.protocol} session initiated by {source.ip}:{source.port} to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "action.name",
                "value": "server-rst"
            },
            {
                "field": "action.outcome",
                "value": "success"
            },
            {
                "field": "network.protocol"
            },
            {
                "field": "observer.hostname"
            },
            {
                "field": "network.protocol"
            },
            {
            "field": "source.port"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ]
    },
    {
        "value": "{observer.hostname} observed timeout {network.protocol} session initiated by {source.ip}:{source.port} to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "action.name",
                "value": "timeout"
            },
            {
                "field": "action.outcome",
                "value": "success"
            },
            {
                "field": "network.protocol"
            },
            {
                "field": "observer.hostname"
            },
            {
            "field": "source.port"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ]
    },
    {
        "value": "{observer.hostname} observed start {network.protocol} session initiated by {source.ip}:{source.port} to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "action.name",
                "value": "start"
            },
            {
                "field": "action.outcome",
                "value": "success"
            },
            {
                "field": "network.protocol"
            },
            {
                "field": "observer.hostname"
            },
            {
            "field": "source.port"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ]
    },
    {
        "value": "{observer.hostname} observed closing {network.protocol} session initiated by {source.ip}:{source.port} to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "action.name",
                "value": "close"
            },
            {
                "field": "action.outcome",
                "value": "success"
            },
            {
                "field": "network.protocol"
            },
            {
                "field": "observer.hostname"
            },
            {
            "field": "source.port"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ]
    },
    {
        "value": "{observer.hostname} observed DNS session initiated by {source.ip}:{source.port} to {destination.ip}:{destination.port}",
        "conditions": [
            {
                "field": "action.name",
                "value": "dns"
            },
            {
                "field": "action.outcome",
                "value": "success"
            },
            {
                "field": "observer.hostname"
            },
            {
            "field": "source.port"
            },
            {
            "field": "source.ip"
            },
            {
            "field": "destination.ip"
            },
            {
            "field": "destination.port"
            }
        ]
    },
    {
    "value": "Connexion from {source.ip} to {destination.ip}:{destination.domain} action {action.name}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "destination.domain"
      },
      {
        "field": "destination.port"
      },
      {
        "field": "action.name"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.domain",
        "type": "connected to"
      }
    ]
  },
    {
    "value": "Connexion from {source.ip} to {destination.ip}:{destination.port} action {action.name}",
    "conditions": [
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "destination.port"
      },
      {
        "field": "action.name"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "connected to"
      }
    ]
  },
    {
        "value": "{event.reason}",
        "conditions": [
            {
                "field": "event.reason"
            }
        ]
    }
]
