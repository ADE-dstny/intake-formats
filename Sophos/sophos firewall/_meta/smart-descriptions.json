[
  {
    "value": "{user.name} connect to {destination.registered_domain} with Port {source.port} and {network.transport}",
    "conditions": [
      {
        "field": "user.name"
      },
      {
        "field": "destination.registered_domain"
      },
      {
        "field": "source.port"
      },
      {
        "field": "network.transport"
      }   
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "destination.registered_domain",
        "type": "connected to"
      }
    ]
  },
  {
    "value": "{destination.ip} {sophos.action} {sophos.sub} from {source.ip} Port {source.port}",
    "conditions": [
      {
        "field": "sophos.action",
        "value": "accept"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "sophos.sub"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      }            
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "accept"
      }
    ]
  },
  {
    "value": "Action type {sophos.action} identified between {source.ip} and {destination.ip}:{destination.port}",
    "conditions": [
      {
        "field": "sophos.action",
        "value": "DNS request"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "source.port"
      }      
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "make a"
      }
    ]
  },
  {
    "value": "{destination.ip} {sophos.action} {sophos.sub} from {source.ip} Port {source.port}",
    "conditions": [
      {
        "field": "sophos.action",
        "value": "drop"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "sophos.sub"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      }            
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "drop"
      }
    ]
  },
  {
    "value": "{destination.ip} allow {sophos.action} {network.transport} connection from {source.ip} Port {source.port}",
    "conditions": [
      {
        "field": "network.transport",
        "value": "UDP"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "network.transport"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "source.port"
      }            
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "allow"
      }
    ]
  }
]
