name: checkpoint_harmony
pipeline:
  - name: parse_json
    external:
      name: json.parse-json
      properties:
        input_field: "{{original.message}}"
        output_field: message

  - name: set_ecs_fields

stages:
  set_ecs_fields:
    actions:
      - set:
          event.kind: alert
          event.category: network
          event.type: ["info"]
          event.reason: "{{parse_json.message.details}}"
          host.os.type: "{{parse_json.message.device_model}}"
          device.id: "{{parse_json.message.device_id}}"
          checkpoint.harmony.attack_vector: "{{parse_json.message.attack_vector}}"
          checkpoint.harmony.number: "{{parse_json.message.number}}"
          checkpoint.harmony.threat_factors: "{{parse_json.message.threat_factors}}"
          checkpoint.harmony.mdm_uuid: "{{parse_json.message.mdm_uuid}}"
