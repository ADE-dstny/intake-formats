[
  {
    "value": "{host.ip} set {vectra.detection.name}",
    "conditions": [      
      {
         "field": "event.action",
         "value": "INFO"
      },
      {
         "field": "host.ip",
      },
      {
         "field": "vectra.detection.name",
      }      
    ],
    "relationships": [
      {
        "source": "host.ip",
        "target": "destination.ip",
        "type": "set"
      }
    ]
  },
  {
    "value": "{host.ip} logged on to {destination.ip} with {vectra.detection.type} on port {destination.port} and Threat {vectra.risk_score_norm}",
    "conditions": [      
      {
         "field": "event.action",
         "value": "LATERAL MOVEMENT"
      },
      {
         "field": "host.ip",
      },
      {
         "field": "destination.ip",
      },
      {
         "field": "vectra.detection.type",
      },
      {
         "field": "destination.port",
      },
      {
         "field": "vectra.risk_score_norm",
      }        
    ],
    "relationships": [
      {
        "source": "host.ip",
        "target": "destination.ip",
        "type": "logged on to"
      }
    ]
  },
  {
    "value": "{vectra.history.host_access.name} logged on to {observer.ip} with {vectra.detection.last_type}",
    "conditions": [
      {
         "field": "event.action",
         "value": "ACCOUNT SCORING"
      },
      {
         "field": "vectra.history.host_access.name",
      },
      {
         "field": "observer.ip",
      },
      {
         "field": "vectra.detection.last_type",
      }  
    ],
    "relationships": [
      {
        "source": "vectra.history.host_access.name",
        "target": "observer.ip",
        "type": "logged on to"
      }
    ]
  },
    {
    "value": "{observer.ip} connect to {host.ip} with {vectra.detection.last_type} and Threat {vectra.risk_score_norm}",
    "conditions": [
      {
         "field": "event.action",
         "value": "HOST SCORING"
      },
      {
         "field": "observer.ip",
      },
      {
         "field": "host.ip",
      },
      {
         "field": "vectra.detection.last_type",
      },
      {
         "field": "vectra.risk_score_norm",
      }        
    ],
    "relationships": [
      {
        "source": "observer.ip",
        "target": "host.ip",
        "type": "logged on to"
      }
    ]
  },
    {
    "value": "{vectra.detection.reason} to {vectra.destination.name} from {source.ip} to {destination.ip} to {action.name} {vectra.campaign.link}",
    "conditions": [
      {
         "field": "vectra.campaign.link"
      },
      {
         "field": "action.name"
      },
      {
         "field": "vectra.detection.reason",
      },
      {
         "field": "vectra.destination.name",
      },
      {
         "field": "source.ip",
      },
      {
         "field": "destination.ip",
      }   
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "vectra.detection.reason"
      }
    ]
  },
  {
    "value": "{host.ip} logged on to {destination.ip} Port {destination.port} with {vectra.detection.name} and Threat {vectra.risk_score_norm}",
    "conditions": [
      {
         "field": "event.action",
         "value": "COMMAND & CONTROL"
      },
      {
         "field": "host.ip",
      },
      {
         "field": "destination.ip",
      },
      {
         "field": "destination.port",
      },
      {
         "field": "vectra.detection.name",
      },      
      {
         "field": "vectra.risk_score_norm",
      } 
    ],
    "relationships": [
      {
        "source": "host.ip",
        "target": "destination.ip",
        "type": "logged on to"
      }
    ]
  },
    {
    "value": "{host.ip} logged on to {destination.ip} Port {destination.port} with {vectra.detection.name} and Threat {vectra.risk_score_norm}",
    "conditions": [
      {
         "field": "event.action",
         "value": "RECONNAISSANCE"
      },
      {
         "field": "host.ip",
      },
      {
         "field": "destination.ip",
      },
      {
         "field": "destination.port",
      },
      {
         "field": "vectra.detection.name",
      },      
      {
         "field": "vectra.risk_score_norm",
      } 
    ],
    "relationships": [
      {
        "source": "host.ip",
        "target": "destination.ip",
        "type": "logged on to"
      }
    ]
  }
]
